<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Scan - INTELX</title>
    <link rel="stylesheet" href="/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap" rel="stylesheet">
    <script src="https://www.google.com/recaptcha/api.js" async defer></script>
    <style>
      /* Make the terminal less tall so page content is visible on scan page */
      .terminal { max-height: 48vh; overflow: auto; }
      /* Ensure overlay remains above the matrix */
      .overlay { z-index: 2; }
    </style>
  </head>
  <body>
    <div class="overlay">
      <!-- full-screen matrix background for scan page -->
      <canvas id="matrix" style="position:fixed;inset:0;width:100%;height:100%;z-index:0;opacity:1;pointer-events:none;"></canvas>
      <nav class="navbar">
        <a href="/home" class="logo">INTELX</a>
        <ul class="nav-links">
          <li><a href="/home">Home</a></li>
          <li><a href="/resources">Resources</a></li>
          <li><a href="/scan">Scan</a></li>
        </ul>
        <div class="hamburger">☰</div>
      </nav>

      <main class="terminal" role="main" aria-live="polite" tabindex="0" id="terminal">
        <div id="terminal-output" class="terminal-output"></div>
        <div class="input-line">
          <span class="prompt">root@intelx:~$</span>
          <span id="typing" class="typing"></span>
          <span class="caret">█</span>
        </div>
      </main>

      <!-- Removed duplicated nav-banner and homepage intro per user request -->

      <footer>
        <p>&copy; 2025 INTELX. All rights reserved.</p>
      </footer>
    </div>

    <div style="padding:24px;color:#bfffbf;font-family: 'Share Tech Mono', monospace;">
      <div style="display:flex;gap:8px;align-items:center;">
        <input id="scan-target" placeholder="Enter target (e.g. 192.168.0.0/24)" style="padding:8px;border-radius:6px;background:rgba(0,0,0,0.22);border:1px solid rgba(0,255,0,0.06);color:#bfffbf;min-width:260px;" />
        <button id="scan-run" style="padding:8px 12px;border-radius:6px;background:linear-gradient(90deg,#073,#06c);border:none;color:#001100;font-weight:700;">Run Scan</button>
      </div>
      <pre id="scan-output" style="margin-top:12px;color:#9ff29f;white-space:pre-wrap;max-height:280px;overflow:auto;padding:12px;border-radius:6px;background:rgba(0,0,0,0.16);border:1px solid rgba(0,255,0,0.04);"></pre>
      <p style="margin-top:12px"><a href="/home" style="color:#9ff29f">Back to main</a></p>
    </div>

    <script src="/script.js" defer></script>
    <script>
      function generateScanReport(target){
        const now = new Date();
        const filename = 'intelx-scan-'+now.toISOString().replace(/[:.]/g,'-')+'.txt';
        const hosts = [
          { ip: '192.168.0.2', ports: [22,80] },
          { ip: '192.168.0.10', ports: [80] },
          { ip: '192.168.0.15', ports: [22,443,3306] }
        ];
        const lines = [];
        lines.push('INTELX Scan Report');
        lines.push('Target: ' + target);
        lines.push('Generated: ' + now.toISOString());
        lines.push('');
        lines.push('Discovered hosts:');
        hosts.forEach(h => lines.push('- ' + h.ip + '  open ports: ' + h.ports.join(',')));
        lines.push('');
        lines.push('Summary: ' + hosts.length + ' hosts found.');
        return { filename: filename, text: lines.join('\n') };
      }

      document.getElementById('scan-run').addEventListener('click', () => {
        const tgt = (document.getElementById('scan-target').value || 'local-network').trim();
        const out = document.getElementById('scan-output');
        out.textContent = 'Running simulated scan on: ' + tgt + '\nScanning...';
        setTimeout(() => {
          const r = generateScanReport(tgt);
          out.textContent = 'Scan complete.\n\n' + r.text;
          const blob = new Blob([r.text], { type: 'text/plain' });
          const url = URL.createObjectURL(blob);
          const a = document.createElement('a');
          a.href = url; a.download = r.filename; a.textContent = 'Download ' + r.filename;
          a.style.display = 'inline-block'; a.style.marginTop = '8px'; a.style.color = '#7fff7f';
          const wrap = document.createElement('div'); wrap.appendChild(a); out.appendChild(wrap);
        }, 1000 + Math.random() * 800);
      });
    </script>
  </body>
</html>
